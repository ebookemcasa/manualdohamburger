<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fundamentos da Cozinha - Mestre Culin√°rio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Lato:wght@400;700&display=swap');
        body { font-family: 'Lato', sans-serif; background-color: #f8f7f4; color: #3d3d3d; }
        h1, h2, h3, h4, .nav-link { font-family: 'Playfair Display', serif; }
        
        /* Estilos para interatividade */
        .aula-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }
        .aula-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.05), 0 4px 6px -4px rgb(0 0 0 / 0.05);
        }
        
        /* Checklist de Ingredientes */
        .ingredient-item input[type="checkbox"] {
            display: none;
        }
        .ingredient-item span {
            transition: all 0.2s ease;
            cursor: pointer;
        }
        .ingredient-item input[type="checkbox"]:checked + span {
            text-decoration: line-through;
            opacity: 0.6;
        }

        /* Acordion/Sanfona para os Passos */
        details > summary {
            cursor: pointer;
            list-style: none;
            display: inline-flex;
            align-items: center;
            transition: color 0.2s ease;
        }
        details > summary::-webkit-details-marker {
            display: none;
        }
        details > summary::before {
            content: '‚ñ∂';
            margin-right: 8px;
            font-size: 0.7em;
            transition: transform 0.2s ease-in-out;
        }
        details[open] > summary::before {
            transform: rotate(90deg);
        }

        /* Tooltips para termos t√©cnicos */
        .tooltip {
            position: relative;
            cursor: help;
            border-bottom: 2px dotted #ca8a04;
            font-weight: bold;
        }
        .tooltip::after {
            content: attr(data-tooltip); /* Puxa o texto do atributo data-tooltip */
            position: absolute;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
            width: 220px;
            background-color: #3d3d3d;
            color: #fff;
            font-family: 'Lato', sans-serif;
            font-weight: normal;
            text-align: center;
            padding: 8px;
            border-radius: 6px;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease;
        }
        .tooltip:hover::after {
            opacity: 1;
            visibility: visible;
        }
    </style>
</head>
<body class="antialiased">
    <header class="bg-white/90 backdrop-blur-lg sticky top-0 z-50 shadow-md">
        </header>
    <main class="container mx-auto px-6 py-8 md:py-12">
        <section id="page-title" class="text-center mb-16">
            <h1 class="text-4xl md:text-6xl font-bold text-stone-800">Fundamentos da <span class="text-amber-600">Cozinha</span></h1>
            <p class="mt-4 max-w-2xl mx-auto text-stone-600">A base de tudo. Domine estas t√©cnicas essenciais e desbloqueie o seu potencial para criar qualquer prato com confian√ßa.</p>
        </section>

        <div id="aulas-list" class="space-y-8 max-w-5xl mx-auto">
            <div class="aula-card bg-white p-6 rounded-lg shadow-lg" data-target="receita-mise-en-place"><h2 class="text-2xl md:text-3xl font-bold text-amber-700">Aula 01: Mise en Place (A Arte da Organiza√ß√£o)</h2><p class="text-stone-600 mt-2">A t√©cnica mais importante de todas n√£o √© sobre cozinhar, mas sobre se preparar para cozinhar.</p></div>
            <div class="aula-card bg-white p-6 rounded-lg shadow-lg" data-target="receita-cortes"><h2 class="text-2xl md:text-3xl font-bold text-amber-700">Aula 02: As T√©cnicas de Corte Essenciais</h2><p class="text-stone-600 mt-2">Aprenda a cortar como um chef para um cozimento uniforme e uma apresenta√ß√£o impec√°vel.</p></div>
            <div class="aula-card bg-white p-6 rounded-lg shadow-lg" data-target="receita-caldo"><h2 class="text-2xl md:text-3xl font-bold text-amber-700">Aula 03: Caldo de Legumes Caseiro</h2><p class="text-stone-600 mt-2">A base de sabor para sopas, risotos e molhos. Nunca mais use um cubo industrializado.</p></div>
            <div class="aula-card bg-white p-6 rounded-lg shadow-lg" data-target="receita-arroz"><h2 class="text-2xl md:text-3xl font-bold text-amber-700">Aula 04: O Arroz Perfeito (Soltinho)</h2><p class="text-stone-600 mt-2">Aprenda a t√©cnica infal√≠vel para nunca mais ter um arroz empapado.</p></div>
            <div class="aula-card bg-white p-6 rounded-lg shadow-lg" data-target="receita-refogado"><h2 class="text-2xl md:text-3xl font-bold text-amber-700">Aula 05: A Base de Sabor (Mirepoix e Sofrito)</h2><p class="text-stone-600 mt-2">Entenda como construir camadas de sabor desde o primeiro passo de qualquer receita.</p></div>
            <div class="aula-card bg-white p-6 rounded-lg shadow-lg" data-target="receita-cebola-caramelizada"><h2 class="text-2xl md:text-3xl font-bold text-amber-700">Aula 06: Cebola Caramelizada</h2><p class="text-stone-600 mt-2">Transforme uma simples cebola numa base doce e complexa para hamb√∫rgueres, molhos e mais.</p></div>
            <div class="aula-card bg-white p-6 rounded-lg shadow-lg" data-target="receita-molho-tomate"><h2 class="text-2xl md:text-3xl font-bold text-amber-700">Aula 07: Molho de Tomate Caseiro</h2><p class="text-stone-600 mt-2">A base para massas, pizzas e muito mais, sem conservantes.</p></div>
            <div class="aula-card bg-white p-6 rounded-lg shadow-lg" data-target="receita-bechamel"><h2 class="text-2xl md:text-3xl font-bold text-amber-700">Aula 08: Molho B√©chamel (Molho Branco)</h2><p class="text-stone-600 mt-2">Domine um dos cinco "molhos m√£e" da culin√°ria francesa, sem grumos.</p></div>
            <div class="aula-card bg-white p-6 rounded-lg shadow-lg" data-target="receita-risoto-base"><h2 class="text-2xl md:text-3xl font-bold text-amber-700">Aula 09: Risoto Base (Tostatura e Mantecatura)</h2><p class="text-stone-600 mt-2">Aprenda a t√©cnica italiana para um risoto cremoso que serve de base para qualquer sabor.</p></div>
            <div class="aula-card bg-white p-6 rounded-lg shadow-lg" data-target="receita-branqueamento"><h2 class="text-2xl md:text-3xl font-bold text-amber-700">Aula 10: Branqueamento e Choque T√©rmico</h2><p class="text-stone-600 mt-2">Aprenda a pr√©-cozinhar vegetais para manter a cor vibrante e a textura perfeita.</p></div>
        </div>

        <div id="receitas-container" class="hidden">
            <button id="back-to-list-btn" class="mb-8 inline-flex items-center text-amber-700 hover:text-amber-800 font-bold"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>Voltar ao √çndice de Aulas</button>
            <div id="receita-mise-en-place" class="receita-content bg-white p-8 rounded-lg shadow-xl max-w-7xl mx-auto hidden"></div>
            <div id="receita-cortes" class="receita-content bg-white p-8 rounded-lg shadow-xl max-w-7xl mx-auto hidden"></div>
            <div id="receita-caldo" class="receita-content bg-white p-8 rounded-lg shadow-xl max-w-7xl mx-auto hidden"></div>
            <div id="receita-arroz" class="receita-content bg-white p-8 rounded-lg shadow-xl max-w-7xl mx-auto hidden"></div>
            <div id="receita-refogado" class="receita-content bg-white p-8 rounded-lg shadow-xl max-w-7xl mx-auto hidden"></div>
            <div id="receita-cebola-caramelizada" class="receita-content bg-white p-8 rounded-lg shadow-xl max-w-7xl mx-auto hidden"></div>
            <div id="receita-molho-tomate" class="receita-content bg-white p-8 rounded-lg shadow-xl max-w-7xl mx-auto hidden"></div>
            <div id="receita-bechamel" class="receita-content bg-white p-8 rounded-lg shadow-xl max-w-7xl mx-auto hidden"></div>
            <div id="receita-risoto-base" class="receita-content bg-white p-8 rounded-lg shadow-xl max-w-7xl mx-auto hidden"></div>
            <div id="receita-branqueamento" class="receita-content bg-white p-8 rounded-lg shadow-xl max-w-7xl mx-auto hidden"></div>
        </div>
    </main>
    <footer class="bg-white border-t mt-16"><div class="container mx-auto px-6 py-8 text-center text-stone-600"><p>&copy; 2024 Mestre Culin√°rio. Todos os direitos reservados.</p></div></footer>

    <script src="database.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const aulas = {
            'mise-en-place': {
                title: "Aula 01: Mise en Place (A Arte da Organiza√ß√£o)",
                description: "A t√©cnica francesa que significa 'tudo no seu lugar'. √â o segredo dos chefs para cozinhar de forma calma, organizada e sem stress, garantindo que todos os ingredientes est√£o prontos antes de ligar o fog√£o.",
                details: { tempoPreparo: "Vari√°vel", tempoCozimento: "N/A", tempoDescanso: "N/A", rendimento: "1 cozinha organizada", dificuldade: "Essencial", utensilios: ["Tigelas pequenas (ramequins)", "T√°bua de corte", "Faca de chef"] },
                dicaDeMestre: "Fa√ßa o 'mise en place' at√© para as receitas mais simples, como um ovo estrelado. Pese o sal, coloque a gordura √† m√£o. Isto cria o h√°bito da organiza√ß√£o, que √© a funda√ß√£o de toda a boa cozinha.",
                ingredients: [],
                steps: [
                    { title: "Ler a Receita Completa", description: "Antes de tocar em qualquer ingrediente, leia a receita do in√≠cio ao fim, duas vezes. Entenda cada passo, cada tempo de cozedura e cada t√©cnica necess√°ria.", porque: "Isto evita surpresas a meio do processo, como descobrir que um ingrediente precisava de marinar por 2 horas ou que necessita de um utens√≠lio que n√£o tem.", pontoCritico: "N√£o se limite a ler os ingredientes. Entenda o processo. Visualize-se a executar cada passo." },
                    { title: "Reunir e Preparar os Ingredientes", description: "Junte todos os ingredientes na sua bancada. Lave, descasque, pique, rale e me√ßa tudo o que for necess√°rio. Coloque cada ingrediente preparado em tigelas pequenas e separadas.", porque: "Ter tudo pronto e medido permite-lhe focar-se exclusivamente na t√©cnica de cozinhar (o controlo do calor, o ponto de cozedura) sem ter de parar para picar uma cebola enquanto o alho j√° est√° a queimar na panela.", pontoCritico: "A prepara√ß√£o inclui l√≠quidos. Me√ßa a √°gua, o vinho, o caldo e tenha-os prontos a usar." },
                    { title: "Organizar a Esta√ß√£o de Trabalho", description: "Posicione os seus ingredientes preparados na ordem em que ser√£o usados. Mantenha a sua t√°bua de corte limpa e tenha uma tigela para o lixo/desperd√≠cios. Posicione as panelas e ferramentas que ir√° usar.", porque: "Uma esta√ß√£o de trabalho l√≥gica e limpa cria um fluxo de trabalho eficiente e seguro. Reduz o movimento desnecess√°rio e a confus√£o, o que por sua vez reduz o stress e a probabilidade de erros.", pontoCritico: "Cozinhe num ambiente limpo. Limpe √† medida que avan√ßa ('clean as you go') para manter a organiza√ß√£o do in√≠cio ao fim." }
                ],
                variacoes: []
            },
            'cortes': {
                title: "Aula 02: As T√©cnicas de Corte Essenciais",
                description: "Aprenda a manusear uma faca de chef com seguran√ßa e a executar os cortes fundamentais (Julienne, Brunoise, Chiffonade). Cortes uniformes n√£o s√£o apenas bonitos, s√£o a chave para um cozimento perfeito.",
                details: { tempoPreparo: "20 min (pr√°tica)", tempoCozimento: "N/A", tempoDescanso: "N/A", rendimento: "Legumes bem cortados", dificuldade: "Intermedi√°rio", utensilios: ["Faca de chef afiada", "T√°bua de corte est√°vel"] },
                dicaDeMestre: "Use a t√©cnica da 'garra' (m√£o-guia). Curve os dedos da m√£o que segura o alimento para dentro, usando os n√≥s dos dedos como um guia seguro para a l√¢mina da faca. A ponta da faca deve manter-se sempre em contacto com a t√°bua.",
                ingredients: [
                    { name: 'Cenoura (para Julienne/Brunoise)', base_qty: 1, unit: 'unid.' },
                    { name: 'Cebola (para Brunoise)', base_qty: 1, unit: 'unid.' },
                    { name: 'Folhas de Manjeric√£o ou Couve (para Chiffonade)', base_qty: 1, unit: 'punhado' }
                ],
                steps: [
                    { title: "Julienne (Tiras Finas)", description: "Corte o legume (ex: cenoura) em sec√ß√µes de 5-7 cm. Crie uma base est√°vel, cortando uma fatia fina de um dos lados. Corte o legume em fatias finas e uniformes. Empilhe as fatias e corte-as novamente em tiras muito finas, como palitos de f√≥sforo.", porque: "Este corte √© ideal para salteados r√°pidos ou guarni√ß√µes, pois a sua grande √°rea de superf√≠cie permite um cozimento muito r√°pido e uniforme.", pontoCritico: "A uniformidade √© a chave. Todas as tiras devem ter a mesma espessura para cozinharem ao mesmo tempo." },
                    { title: "Brunoise (Cubos Pequenos)", description: "Comece por fazer um corte Julienne. Junte os 'palitos' e corte-os transversalmente para formar cubos min√∫sculos e perfeitos (idealmente 2mm x 2mm x 2mm).", porque: "O corte Brunoise √© a base de muitos refogados (<span class='tooltip' data-tooltip='Base cl√°ssica de 2 partes de cebola, 1 de cenoura e 1 de aipo, cortados em brunoise.'>mirepoix</span>) e molhos, pois os pequenos cubos dissolvem-se e libertam o seu sabor de forma eficiente.", pontoCritico: "Mantenha a ponta da faca na t√°bua e use um movimento de balan√ßo para mais controlo e precis√£o." },
                    { title: "Chiffonade (Tiras de Folhas)", description: "Empilhe as folhas (ex: manjeric√£o) umas sobre as outras. Enrole-as firmemente, como um charuto. Fatie o 'charuto' transversalmente o mais fino que conseguir.", porque: "Esta t√©cnica permite cortar ervas e folhas delicadas em fitas finas e elegantes, perfeitas para guarni√ß√µes, sem as esmagar ou oxidar.", pontoCritico: "Use uma faca muito bem afiada para n√£o rasgar as folhas." }
                ],
                variacoes: []
            },
            'caldo': {
                title: "Aula 03: Caldo de Legumes Caseiro",
                description: "O caldo √© a alma de in√∫meros pratos. Aprenda a fazer um caldo de legumes rico, dourado e cheio de sabor, que servir√° de base para as suas sopas, molhos e risotos. A diferen√ßa para um caldo industrializado √© abismal.",
                calculator: { label: "Litros de Caldo:", unit: "caldo-input", base_value: 2, default_value: 2 },
                details: { tempoPreparo: "15 min", tempoCozimento: "1-2 horas", tempoDescanso: "N/A", rendimento: "Aprox. 2 litros", dificuldade: "F√°cil", utensilios: ["Panela grande e alta (caldeir√£o)", "Coador de malha fina", "Faca de chef"] },
                dicaDeMestre: "Guarde as aparas de legumes (cascas de cebola, pontas de cenoura, talos de salsa) num saco no congelador. Quando tiver uma boa quantidade, use-as para fazer o seu caldo. √â uma forma fant√°stica de reduzir o desperd√≠cio e aproveitar 100% dos ingredientes.",
                ingredients: [
                    { name: 'Cebolas, com casca, cortadas ao meio', base_qty: 2, unit: 'unid.', scalable: true },
                    { name: 'Cenouras, em peda√ßos grandes', base_qty: 2, unit: 'unid.', scalable: true },
                    { name: 'Talos de Aipo, em peda√ßos grandes', base_qty: 2, unit: 'unid.', scalable: true },
                    { name: '√Ågua fria', base_qty: 3, unit: 'litros', scalable: true }
                ],
                steps: [
                    { title: "Preparar os Arom√°ticos", description: "Lave bem todos os legumes. N√£o precisa de os descascar, apenas corte-os em peda√ßos grandes. A casca da cebola adiciona uma bela cor dourada.", porque: "Um caldo √© uma infus√£o lenta. Cortes grandes exp√µem a superf√≠cie dos legumes o suficiente para libertar o sabor ao longo do tempo.", pontoCritico: "Evite usar vegetais cruc√≠feros em excesso (como br√≥colos), pois podem dar um sabor amargo ao caldo." },
                    { title: "O Cozimento Lento", description: "Coloque todos os ingredientes numa panela grande. Cubra com √°gua FRIA. Leve a ferver, e depois reduza imediatamente para um <span class='tooltip' data-tooltip='Cozimento muito lento em l√≠quido, onde apenas uma ou duas bolhas sobem √† superf√≠cie de vez em quando.'>simmer</span> muito suave por 1 a 2 horas.", porque: "Come√ßar com √°gua fria extrai o sabor de forma mais eficiente. Um simmer suave mant√©m o caldo l√≠mpido.", pontoCritico: "N√£o adicione sal ao caldo! O caldo √© uma base que ser√° usada noutras receitas que levar√£o sal.", timer: 5400 },
                    { title: "Coar e Armazenar", description: "Coe o l√≠quido atrav√©s de um passador de malha fina. Deixe o caldo arrefecer completamente antes de o guardar.", porque: "Coar remove todas as impurezas, resultando num caldo l√≠mpido e puro. Arrefecer rapidamente √© importante para a seguran√ßa alimentar.", pontoCritico: "N√£o pressione os legumes contra o coador. Isso ir√° turvar o seu caldo." }
                ],
                 variacoes: ["<strong>Caldo de Cogumelos:</strong> Adicione cogumelos secos (porcini) para um sabor <span class='tooltip' data-tooltip='O 'quinto gosto', profundo e saboroso, encontrado em queijos curados, cogumelos e carnes.'>umami</span> intenso.", "<strong>Caldo Tostado:</strong> Asse os legumes no forno a 200¬∞C at√© ficarem bem dourados antes de os colocar na panela com √°gua.", "<strong>Caldo de Frango:</strong> Adicione uma carca√ßa de frango assado ou peda√ßos de frango com osso junto com os legumes."]
            },
            'arroz': {
                title: "Aula 04: O Arroz Perfeito (Soltinho)",
                description: "Dominar o arroz branco soltinho √© o primeiro passo para se sentir confiante na cozinha. Com esta t√©cnica, voc√™ aprender√° a import√¢ncia de cada etapa para um resultado que nunca falha.",
                calculator: { label: "Ch√°venas de Arroz Cru:", unit: "arroz-input", base_value: 1, default_value: 1 },
                details: { tempoPreparo: "5 min", tempoCozimento: "15 min", tempoDescanso: "5 min", rendimento: "2 por√ß√µes por ch√°vena", dificuldade: "F√°cil", utensilios: ["Panela com tampa", "Garfo", "Copo medidor"] },
                dicaDeMestre: "Depois de soltar o arroz com o garfo, coloque um pano de prato limpo entre a panela e a tampa durante o descanso. O pano absorve o excesso de vapor, garantindo um arroz ainda mais seco e soltinho.",
                ingredients: [
                    { name: 'Arroz Agulha', base_qty: 1, unit: 'ch√°vena', scalable: true },
                    { name: '√Ågua a ferver', base_qty: 2, unit: 'ch√°venas', scalable: true },
                    { name: 'Azeite ou √ìleo', base_qty: 1, unit: 'c. de sopa', scalable: true },
                    { name: 'Alho Picado', base_qty: 1, unit: 'dente', scalable: true },
                    { name: 'Sal', base_qty: 0.5, unit: 'c. de ch√°', scalable: true }
                ],
                steps: [
                    { title: "O Refogado (Base de Sabor)", description: "Numa panela, aque√ßa o azeite em lume m√©dio. Adicione o alho e refogue at√© perfumar (cerca de 30s). Adicione o arroz e 'frite-o' por cerca de 1 minuto, mexendo sempre. Este passo √© crucial.", porque: "Este processo, chamado 'selar' o arroz, reveste cada gr√£o com gordura. Isto ajuda a manter os gr√£os separados durante o cozimento, evitando que o amido se liberte em excesso e crie um resultado empapado.", pontoCritico: "N√£o deixe o alho queimar, sen√£o amargar√° todo o prato. Ao 'fritar' o arroz, mexa constantemente para que todos os gr√£os sejam revestidos." },
                    { title: "A Cozedura Perfeita", description: "Adicione a √°gua **j√° a ferver** √† panela. Tempere com sal e mexa uma √∫nica vez para distribuir os gr√£os. Reduza para o lume mais baixo poss√≠vel, semi-tape a panela e cozinhe por 10 a 15 minutos, ou at√© a √°gua ser absorvida.", porque: "Adicionar √°gua fervente mant√©m a temperatura constante e inicia o cozimento imediatamente e de forma uniforme. N√£o mexer mais evita que o amido se solte dos gr√£os, o que √© o principal culpado do arroz 'papa'.", pontoCritico: "Resista √† tenta√ß√£o de mexer! Apenas confie no processo. O lume deve ser o mais baixo que o seu fog√£o permite para que a √°gua evapore lentamente.", timer: 720 },
                    { title: "O Descanso (O Passo Secreto)", description: "Quando a √°gua tiver sido absorvida, desligue o lume, tape completamente a panela e deixe o arroz descansar por pelo menos 5 minutos. Depois deste tempo, solte os gr√£os gentilmente com um garfo.", porque: "O vapor residual dentro da panela termina o cozimento dos gr√£os de forma suave e uniforme. Este passo √© o que garante a textura perfeita e evita que os gr√£os do fundo cozinhem mais do que os de cima.", pontoCritico: "N√£o salte o descanso. Se servir imediatamente, o arroz pode parecer um pouco h√∫mido. Os 5 minutos de descanso fazem toda a diferen√ßa.", timer: 300 }
                ],
                variacoes: ["<strong>Arroz com Cenoura:</strong> Adicione cenoura ralada junto com o arroz para 'fritar'.", "<strong>Arroz com Br√≥colos:</strong> Adicione pequenos floretes de br√≥colos nos √∫ltimos 5 minutos de cozimento, por cima do arroz.", "<strong>Arroz Amarelo:</strong> Adicione uma pitada de a√ßafr√£o-da-terra (c√∫rcuma) na √°gua para dar cor e um sabor extra."]
            },
            'refogado': {
                title: "Aula 05: A Base de Sabor (Mirepoix e Sofrito)",
                description: "Aprenda a construir a funda√ß√£o de sabor de in√∫meros pratos. Dominar o refogado lento de arom√°ticos √© o que separa a cozinha amadora da profissional.",
                details: { tempoPreparo: "10 min", tempoCozimento: "10-15 min", tempoDescanso: "N/A", rendimento: "Base para 1 receita", dificuldade: "F√°cil", utensilios: ["Panela ou frigideira", "Faca de chef"] },
                dicaDeMestre: "O segredo de um bom refogado √© o tempo e o lume baixo. N√£o tenha pressa. O objetivo n√£o √© dourar ou fritar os legumes, mas sim 'su√°-los' lentamente para que eles libertem os seus a√ß√∫cares e sabor sem ganhar cor.",
                ingredients: [
                    { name: 'Cebola, em brunoise', base_qty: 1, unit: 'unid.', heading: 'Mirepoix/Sofrito Cl√°ssico' },
                    { name: 'Cenoura, em brunoise', base_qty: 1, unit: 'unid.' },
                    { name: 'Aipo, em brunoise', base_qty: 1, unit: 'talo' },
                    { name: 'Azeite ou Manteiga', base_qty: 2, unit: 'c. de sopa' }
                ],
                steps: [
                    { title: "O Corte Uniforme", description: "Pique a cebola, a cenoura e o aipo em <span class='tooltip' data-tooltip='Corte em cubos muito pequenos e uniformes (aprox. 2mm).'>brunoise</span> (cubos pequenos e uniformes).", porque: "Um corte uniforme garante que todos os legumes cozinham ao mesmo tempo, criando uma base de sabor homog√©nea.", pontoCritico: "A propor√ß√£o cl√°ssica do Mirepoix franc√™s √© 2 partes de cebola para 1 de cenoura e 1 de aipo." },
                    { title: "O Cozimento Lento", description: "Aque√ßa a gordura (azeite ou manteiga) numa panela em lume m√©dio-baixo. Adicione a cebola e uma pitada de sal. Cozinhe por 5 minutos at√© amolecer. Adicione a cenoura e o aipo e cozinhe por mais 10 minutos, mexendo ocasionalmente, at√© todos os legumes estarem muito macios e perfumados.", porque: "O sal ajuda a extrair a humidade dos legumes, ajudando-os a 'suar' em vez de fritar. O cozimento lento quebra as fibras e liberta a do√ßura natural dos vegetais, criando uma base de sabor profunda e complexa.", pontoCritico: "Mantenha o lume baixo. Se os legumes come√ßarem a ganhar cor (a dourar), o lume est√° muito alto." }
                ],
                variacoes: [
                    "<strong>Sofrito Latino/Italiano:</strong> Geralmente inclui alho e, por vezes, pimento. O alho √© adicionado no final, pois cozinha mais r√°pido.",
                    "<strong>Holy Trinity (Cajun):</strong> Substitui a cenoura por pimento verde. A propor√ß√£o √© 1 parte de cebola, 1 de aipo e 1 de pimento verde.",
                    "<strong>Refogado Portugu√™s/Brasileiro:</strong> Frequentemente come√ßa com cebola e alho, e pode incluir tomate e louro."
                ]
            },
            'cebola-caramelizada': {
                title: "Aula 06: Cebola Caramelizada",
                description: "Paci√™ncia √© o ingrediente secreto. Aprenda a cozinhar cebolas lentamente para libertar os seus a√ß√∫cares naturais, transformando-as num acompanhamento doce, profundo e incrivelmente vers√°til.",
                calculator: { label: "Quilos de Cebola:", unit: "cebola-caramelizada-input", base_value: 1, default_value: 1 },
                details: { tempoPreparo: "5 min", tempoCozimento: "45-60 min", tempoDescanso: "N/A", rendimento: "Aprox. 1 ch√°vena", dificuldade: "F√°cil", utensilios: ["Frigideira larga e de fundo grosso", "Colher de pau"] },
                dicaDeMestre: "N√£o tenha pressa. A carameliza√ß√£o √© um processo lento. Se aumentar o lume para acelerar, as cebolas ir√£o queimar por fora em vez de cozinharem e libertarem os seus a√ß√∫cares de forma uniforme.",
                ingredients: [
                    { name: 'Cebolas amarelas grandes', base_qty: 1, unit: 'kg', scalable: true },
                    { name: 'Manteiga sem sal', base_qty: 2, unit: 'c. de sopa', scalable: true },
                    { name: 'Azeite', base_qty: 1, unit: 'c. de sopa', scalable: true },
                    { name: 'Sal', base_qty: 0.5, unit: 'c. de ch√°', scalable: true },
                    { name: '√Ågua ou Vinho Branco (para deglacear)', base_qty: 50, unit: 'ml', scalable: true }
                ],
                steps: [
                    { title: "Preparar as Cebolas", description: "Descasque as cebolas e corte-as em fatias finas e uniformes.", porque: "Fatias uniformes garantem que todas as cebolas cozinham ao mesmo tempo, evitando que umas queimem enquanto outras ainda est√£o cruas.", pontoCritico: "Corte no sentido do comprimento (de polo a polo) para fatias que mant√™m melhor a sua forma, ou contra as fibras para uma carameliza√ß√£o mais r√°pida." },
                    { title: "O Cozimento Lento", description: "Numa frigideira larga, derreta a manteiga com o azeite em lume m√©dio-baixo. Adicione as cebolas fatiadas e o sal. Cozinhe lentamente, mexendo ocasionalmente, por 45 a 60 minutos.", porque: "O sal ajuda a extrair a humidade das cebolas, o que as impede de fritar e as ajuda a cozinhar no seu pr√≥prio l√≠quido. O lume baixo √© crucial para n√£o queimar os a√ß√∫cares.", pontoCritico: "Nos primeiros 10 minutos, pode tapar a panela para acelerar a liberta√ß√£o de √°gua. Depois, cozinhe sempre destapado." },
                    { title: "Deglacear e Finalizar", description: "√Ä medida que as cebolas cozinham, elas come√ßar√£o a colar no fundo da panela, criando uma crosta acastanhada (o 'fond'). Quando isso acontecer, adicione um pouco de √°gua ou vinho para <span class='tooltip' data-tooltip='Adicionar um l√≠quido a uma panela quente para soltar os peda√ßos de comida caramelizados (fond) do fundo.'>deglacear</span>, raspando o fundo com a colher. Repita este processo sempre que necess√°rio. As cebolas est√£o prontas quando estiverem muito macias, doces e com uma cor de caramelo profundo.", porque: "O 'fond' no fundo da panela √© sabor concentrado. Deglacear reincorpora esse sabor nas cebolas, intensificando o resultado final.", pontoCritico: "A cor final deve ser um castanho-escuro rico, n√£o preto. Se come√ßar a cheirar a queimado, o lume est√° muito alto." }
                ],
                variacoes: [
                    "<strong>Com Vinagre Bals√¢mico:</strong> Adicione um fio de vinagre bals√¢mico no final para um toque agridoce.",
                    "<strong>Com Ervas:</strong> Junte um ramo de tomilho √†s cebolas durante o cozimento.",
                    "<strong>Para Congelar:</strong> Pode fazer uma grande quantidade e congelar em pequenas por√ß√µes para usar em sopas, molhos e recheios."
                ]
            },
            'molho-tomate': {
                title: "Aula 07: Molho de Tomate Caseiro",
                description: "Abandone os molhos de compra. Fazer o seu pr√≥prio molho de tomate √© simples, mais saud√°vel e resulta num sabor incomparavelmente mais fresco e aut√™ntico.",
                calculator: { label: "Quilos de Tomate Fresco:", unit: "tomate-input", base_value: 1, default_value: 1 },
                details: { tempoPreparo: "15 min", tempoCozimento: "45 min", tempoDescanso: "N/A", rendimento: "~750ml por kg de tomate", dificuldade: "F√°cil", utensilios: ["Panela grande", "Faca", "Colher de pau"] },
                dicaDeMestre: "Para um molho com uma textura mais aveludada, passe-o por um passador de legumes (passe-vite) ou bata-o com uma varinha m√°gica no final do cozimento.",
                ingredients: [
                    { name: 'Tomate maduro (italiano √© ideal)', base_qty: 1, unit: 'kg', scalable: true },
                    { name: 'Azeite Extra Virgem', base_qty: 2, unit: 'c. de sopa', scalable: true },
                    { name: 'Cebola M√©dia Picada', base_qty: 1, unit: 'unid.', scalable: true },
                    { name: 'Alho Picado', base_qty: 2, unit: 'dente(s)', scalable: true }
                ],
                steps: [
                    { title: "Preparar os Tomates", description: "Lave bem os tomates. Para retirar a pele, fa√ßa um 'X' na base de cada tomate, mergulhe em √°gua fervente por 30 segundos e depois em √°gua gelada. A pele sair√° facilmente.", porque: "Retirar a pele e as sementes resulta num molho menos √°cido e com uma textura mais suave.", pontoCritico: "Use sempre tomates bem maduros. Tomates verdes ou pouco maduros resultar√£o num molho √°cido e com menos cor." },
                    { title: `O Sofrito (A Base Arom√°tica)`, description: "Numa panela grande, aque√ßa o azeite em lume m√©dio. Adicione a cebola e refogue at√© ficar macia e transl√∫cida (cerca de 5-7 minutos). Junte o alho e cozinhe por mais um minuto.", porque: "Cozinhar a cebola lentamente liberta os seus a√ß√∫cares naturais, conferindo uma do√ßura de base ao molho.", pontoCritico: "N√£o doure a cebola, apenas a deixe 'suar' e ficar macia. Se a cebola ou o alho queimarem, o molho ficar√° amargo." },
                    { title: "Cozinhar e Apurar o Sabor", description: "Adicione os tomates picados √† panela. Tempere com sal e pimenta. Deixe levantar fervura, reduza para o lume mais baixo poss√≠vel e cozinhe, semi-tampado, por pelo menos 45 minutos.", porque: "O cozimento lento e prolongado ('apurar') √© o que funde todos os sabores e concentra a do√ßura do tomate.", pontoCritico: "Mexa o molho ocasionalmente para n√£o colar no fundo da panela.", timer: 2700 }
                ],
                variacoes: ["<strong>Molho 'Arrabbiata':</strong> Adicione uma malagueta seca ou flocos de pimenta ao refogado de alho para um toque picante.", "<strong>Com Ervas:</strong> Adicione um ramo de manjeric√£o ou or√©g√£os nos √∫ltimos minutos de cozedura.", "<strong>Com Vinho:</strong> Depois de refogar o alho, adicione um pouco de vinho tinto e deixe evaporar antes de juntar os tomates."]
            },
            'bechamel': {
                title: "Aula 08: Molho B√©chamel (Molho Branco)",
                description: "Domine um dos cinco 'molhos m√£e' da culin√°ria francesa. Aprenda a fazer um b√©chamel perfeitamente liso, cremoso e sem grumos, a base para lasanhas e in√∫meros gratinados.",
                calculator: { label: "Litros de Leite:", unit: "bechamel-input", base_value: 1, default_value: 1 },
                details: { tempoPreparo: "5 min", tempoCozimento: "10 min", tempoDescanso: "N/A", rendimento: "Aprox. 1 litro", dificuldade: "F√°cil", utensilios: ["Panela", "Batedor de arame (fouet)"] },
                dicaDeMestre: "Para um sabor mais complexo, infunda o leite antes de o usar. Aque√ßa-o com meia cebola, uma folha de louro e alguns cravinhos, deixe repousar por 15 minutos e coe antes de o adicionar ao roux.",
                ingredients: [
                    { name: 'Leite', base_qty: 1, unit: 'litro', scalable: true },
                    { name: 'Manteiga', base_qty: 60, unit: 'g', scalable: true },
                    { name: 'Farinha de Trigo', base_qty: 60, unit: 'g', scalable: true },
                    { name: 'Noz-moscada, mo√≠da na hora', base_qty: 1, unit: 'pitada', scalable: false },
                    { name: 'Sal e Pimenta Branca', base_qty: 0, unit: 'A gosto', scalable: false }
                ],
                steps: [
                    { title: "O Roux (O Espessante)", description: "Numa panela, derreta a manteiga em lume m√©dio. Adicione a farinha e cozinhe esta pasta, chamada <span class='tooltip' data-tooltip='Mistura de gordura e farinha cozida, usada para engrossar molhos.'>roux</span>, por 2 minutos, mexendo sempre.", porque: "Cozinhar o roux √© o passo mais importante para evitar o sabor a farinha crua no molho final.", pontoCritico: "O roux para o b√©chamel deve ser 'branco', ou seja, n√£o deve ganhar cor. Mantenha o lume m√©dio-baixo." },
                    { title: "A Incorpora√ß√£o do Leite", description: "Aque√ßa o leite. Retire a panela com o roux do lume e comece a adicionar o leite quente, aos poucos, batendo vigorosamente com o fouet para incorporar bem antes de adicionar mais.", porque: "Adicionar o l√≠quido quente a uma base quente e bater vigorosamente √© a t√©cnica infal√≠vel para um molho sem grumos.", pontoCritico: "N√£o deite o leite todo de uma vez. A incorpora√ß√£o gradual √© o segredo para uma textura perfeitamente lisa." },
                    { title: "O Cozimento Final", description: "Depois de todo o leite estar incorporado, volte com a panela ao lume m√©dio-baixo. Cozinhe, mexendo sempre, por 5 a 8 minutos, at√© o molho engrossar. Tempere com sal, pimenta branca e noz-moscada.", porque: "O cozimento final √© necess√°rio para que o amido da farinha cozinhe completamente e atinja o seu poder m√°ximo de espessamento.", pontoCritico: "Mexa continuamente, prestando aten√ß√£o aos cantos da panela para evitar que o molho cole e queime.", timer: 480 }
                ],
                variacoes: ["<strong>Molho Mornay (com Queijo):</strong> No final, fora do lume, adicione queijo Gruy√®re ou Emmental ralado e mexa at√© derreter.", "<strong>Para Gratinar:</strong> Use uma propor√ß√£o ligeiramente maior de farinha e manteiga para um molho mais espesso.", "<strong>Vers√£o Vegana:</strong> Use bebida vegetal (aveia ou soja), margarina e um caldo de legumes para mais sabor."]
            },
            'risoto-base': {
                title: "Aula 09: Risoto Base (Tostatura e Mantecatura)",
                description: "Aprenda os pilares da t√©cnica italiana para um risoto perfeitamente cremoso, 'al dente' e aveludado. Dominar o risoto base permite-lhe criar infinitas varia√ß√µes.",
                calculator: { label: "Gramas de Arroz:", unit: "risoto-base-input", base_value: 320, default_value: 320 },
                details: { tempoPreparo: "10 min", tempoCozimento: "20-25 min", tempoDescanso: "2 min", rendimento: "Serve 4 pessoas", dificuldade: "Intermedi√°rio", utensilios: ["Panela larga e de fundo grosso", "Concha", "Panela para o caldo"] },
                dicaDeMestre: "O caldo deve estar sempre a ferver suavemente numa panela ao lado. Adicionar caldo frio ao risoto interrompe o cozimento, 'choca' o gr√£o de arroz e prejudica a liberta√ß√£o do amido.",
                ingredients: [
                    { name: 'Cebola, com casca, cortadas ao meio', base_qty: 2, unit: 'unid.', scalable: true, heading: 'Para o Caldo de Legumes' },
                    { name: 'Cenouras, em peda√ßos grandes', base_qty: 2, unit: 'unid.', scalable: true },
                    { name: 'Talos de Aipo, em peda√ßos grandes', base_qty: 2, unit: 'unid.', scalable: true },
                    { name: '√Ågua fria', base_qty: 3, unit: 'litros', scalable: true },
                    { name: 'Arroz para Risoto (Arborio ou Carnaroli)', base_qty: 320, unit: 'g', scalable: true, heading: 'Para o Risoto' },
                    { name: 'Cebola pequena, picada finamente', base_qty: 1, unit: 'unid.', scalable: true },
                    { name: 'Vinho Branco Seco', base_qty: 100, unit: 'ml', scalable: true },
                    { name: 'Manteiga sem sal, fria em cubos', base_qty: 50, unit: 'g', scalable: true },
                    { name: 'Queijo Parmes√£o, ralado na hora', base_qty: 50, unit: 'g', scalable: true }
                ],
                steps: [
                    { 
                        isSubRecipe: true,
                        title: 'M√≥dulo Essencial: Caldo de Legumes Caseiro',
                        subSteps: [
                            { title: "Preparar e Cozinhar", description: "Numa panela grande, junte os legumes do caldo (cebolas, cenouras, aipo) numa panela grande com a √°gua fria. Leve a ferver e depois reduza para um simmer muito suave. Cozinhe por 1 a 2 horas.", porque: "Um caldo caseiro √© a alma de um bom risoto, fornecendo uma base de sabor muito superior a qualquer caldo industrial. Manter o caldo quente √© essencial para a t√©cnica do risoto.", pontoCritico: "N√£o adicione sal ao caldo. O sal do risoto ser√° ajustado no final, principalmente atrav√©s do queijo." },
                            { title: "Coar e Manter Quente", description: "Coe o caldo para uma panela limpa, descartando os legumes. Mantenha este caldo a ferver suavemente numa panela ao lado durante todo o processo de fazer o risoto.", porque: "Precisamos apenas do l√≠quido saboroso. O caldo deve estar quente para n√£o interromper o cozimento do arroz a cada adi√ß√£o.", pontoCritico: "Tenha sempre mais caldo do que pensa que vai precisar." }
                        ]
                    },
                    { title: "O Sofrito e a 'Tostatura'", description: "Numa panela larga, refogue a cebola picada em metade da manteiga at√© ficar macia e transl√∫cida. Adicione o arroz e mexa constantemente por 2 minutos. Os gr√£os devem ficar quentes e transl√∫cidos nas bordas.", porque: "Tostar o arroz (<span class='tooltip' data-tooltip='Termo italiano para tostar o arroz na gordura antes de adicionar l√≠quido. Sela o gr√£o e melhora a textura.'>tostatura</span>) sela o exterior do gr√£o, ajudando-o a absorver o caldo lentamente sem se desmanchar.", pontoCritico: "N√£o deixe a cebola ou o arroz queimarem. O objetivo √© um calor gentil e constante." },
                    { title: "Adicionar o Caldo, Concha a Concha", description: "Adicione o vinho branco e deixe evaporar completamente. Comece a adicionar o caldo quente, uma concha de cada vez. Mexa frequentemente e espere que o caldo seja quase totalmente absorvido antes de adicionar a pr√≥xima concha. Continue por 18-20 minutos.", porque: "A adi√ß√£o gradual de l√≠quido e a agita√ß√£o constante fazem com que os gr√£os de arroz se friccionem, libertando o seu amido exterior e criando a cremosidade natural.", pontoCritico: "O risoto n√£o precisa de ser mexido sem parar, mas sim frequentemente. O movimento √© o que cria o creme.", timer: 1080 },
                    { title: "A 'Mantecatura' Final", description: "Quando o arroz estiver 'al dente', retire a panela do lume. Adicione o resto da manteiga fria e o queijo parmes√£o. Mexa vigorosamente para emulsionar a gordura e o amido. Tape e deixe descansar por 2 minutos antes de servir.", porque: "Este passo final, a <span class='tooltip' data-tooltip='Ato de finalizar um risoto fora do lume, adicionando gordura (manteiga, queijo) para criar uma emuls√£o final cremosa e aveludada.'>mantecatura</span>, √© o que cria a textura aveludada e a famosa 'onda' ('all'onda') do risoto perfeito.", pontoCritico: "A manteiga deve estar fria para criar o choque t√©rmico que ajuda na emuls√£o." }
                ],
                variacoes: ["<strong>Risoto de Cogumelos:</strong> Salteie cogumelos fatiados e adicione-os ao risoto nos √∫ltimos 5 minutos de cozedura.", "<strong>Risoto alla Milanese:</strong> Adicione pistilos de a√ßafr√£o ao caldo para dar a cor e o sabor cl√°ssicos.", "<strong>Risoto de Ab√≥bora:</strong> Junte pur√© de ab√≥bora cozida ao risoto a meio da cozedura para um resultado doce e cremoso."]
            },
            'branqueamento': {
                title: "Aula 10: Branqueamento e Choque T√©rmico",
                description: "Aprenda a t√©cnica profissional para pr√©-cozinhar vegetais, mantendo a sua cor vibrante, a sua textura crocante e os seus nutrientes. Ideal para preparar legumes para saladas, congelamento ou salteados.",
                details: { tempoPreparo: "5 min", tempoCozimento: "2-5 min", tempoDescanso: "N/A", rendimento: "Qualquer quantidade", dificuldade: "F√°cil", utensilios: ["Panela grande", "Tigela grande com √°gua e gelo", "Escumadeira"] },
                dicaDeMestre: "O tempo de cozimento no branqueamento √© muito curto e varia para cada vegetal. Tenha o banho de gelo pronto antes mesmo de colocar os legumes na √°gua a ferver, pois a transi√ß√£o tem de ser imediata.",
                ingredients: [
                    { name: 'Legumes (ex: br√≥colos, vagem, espargos)', base_qty: 1, unit: 'molho/cabe√ßa' },
                    { name: '√Ågua', base_qty: 0, unit: 'bastante' },
                    { name: 'Sal', base_qty: 1, unit: 'c. de sopa por litro' },
                    { name: 'Gelo', base_qty: 0, unit: 'bastante' }
                ],
                steps: [
                    { title: "Preparar a √Ågua e o Gelo", description: "Encha uma panela grande com √°gua e adicione uma boa quantidade de sal. Leve a ferver vigorosamente. Ao lado, prepare uma tigela grande com √°gua muito fria e bastante gelo (o banho de choque t√©rmico).", porque: "A √°gua deve estar a ferver com for√ßa para que a sua temperatura n√£o baixe muito quando os legumes frios forem adicionados. O banho de gelo √© essencial para parar o cozimento imediatamente.", pontoCritico: "Use bastante sal na √°gua (deve saber a √°gua do mar). Isto tempera os legumes e ajuda a fixar a clorofila, mantendo a cor verde mais vibrante." },
                    { title: "O Branqueamento", description: "Mergulhe os legumes na √°gua a ferver. Cozinhe por um tempo muito curto, apenas at√© ficarem com uma cor verde-viva e ligeiramente tenros, mas ainda crocantes (ex: 2-3 minutos para br√≥colos).", porque: "O <span class='tooltip' data-tooltip='T√©cnica de cozinhar um alimento brevemente em √°gua a ferver.'>branqueamento</span> cozinha o exterior do legume, desativa enzimas que o fariam perder cor e sabor, e remove qualquer sabor a cru.", pontoCritico: "N√£o cozinhe demais. O objetivo √© um pr√©-cozimento, n√£o um cozimento completo. √â melhor errar para menos tempo do que para mais." },
                    { title: "O Choque T√©rmico", description: "Com uma escumadeira, retire imediatamente os legumes da √°gua a ferver e mergulhe-os diretamente no banho de √°gua com gelo. Deixe-os na √°gua gelada at√© arrefecerem completamente.", porque: "O choque t√©rmico para o cozimento de forma instant√¢nea. Se saltar este passo, o calor residual continuar√° a cozinhar os legumes, deixando-os moles, empapados e com uma cor ba√ßa.", pontoCritico: "A transi√ß√£o deve ser o mais r√°pida poss√≠vel. Tenha o banho de gelo mesmo ao lado da panela." }
                ],
                variacoes: ["<strong>Para Congelar:</strong> Esta t√©cnica √© essencial para congelar legumes, pois preserva a sua textura e cor depois de descongelados.", "<strong>Para Saladas:</strong> Use esta t√©cnica para cozinhar vagens ou br√≥colos para uma salada, garantindo que fiquem crocantes e com uma cor viva.", "<strong>Para Salteados:</strong> Branquear legumes mais duros como cenouras ou br√≥colos antes de os saltear garante que cozinhem por completo sem queimar por fora."]
            }
        };

        const aulasList = document.getElementById('aulas-list');
        const pageTitle = document.getElementById('page-title');
        const receitasContainer = document.getElementById('receitas-container');
        const backToListBtn = document.getElementById('back-to-list-btn');
        const menuBtn = document.querySelector('header #menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');

        if(menuBtn && mobileMenu){
            menuBtn.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });
        }
        
        const formatNumber = (num) => {
            if (num < 1 && num > 0) return num.toFixed(2);
            if (num % 1 !== 0) return num.toFixed(1);
            return num;
        };
        
        const updateIngredients = (recipeData, inputValue, recipeId) => {
            const list = document.getElementById(`ingredient-list-${recipeId}`);
            if (!list || !recipeData.ingredients) return;

            const baseValue = recipeData.calculator ? recipeData.calculator.base_value : 1;
            const multiplier = inputValue / baseValue;
            let html = '';
            let currentHeading = '';

            recipeData.ingredients.forEach(ing => {
                if(ing.heading && ing.heading !== currentHeading) {
                    currentHeading = ing.heading;
                    html += `<h5 class="font-bold text-stone-700 mt-3 mb-1">${currentHeading}:</h5>`;
                }
                let qtyDisplay = '';
                if ('scalable' in ing && !ing.scalable) {
                    qtyDisplay = ing.unit;
                } else if(ing.base_qty) {
                    const scaledQty = ing.base_qty * multiplier;
                    qtyDisplay = `${formatNumber(scaledQty)} ${ing.unit}`;
                } else {
                    qtyDisplay = ing.unit || '';
                }
                html += `
                    <li class="ingredient-item">
                        <label class="flex items-center p-1 rounded-md hover:bg-stone-100">
                            <input type="checkbox" class="mr-2 h-4 w-4 text-amber-600 focus:ring-amber-500 border-stone-300 rounded">
                            <span class="flex-1 flex justify-between">
                                <span>${ing.name}</span>
                                <span class="font-semibold text-right pl-2">${qtyDisplay}</span>
                            </span>
                        </label>
                    </li>`;
            });
            list.innerHTML = html;
        };

        const generateRecipeHTML = (recipeData, recipeId) => {
             return `
                <div class="text-center">
                    <h2 class="text-3xl md:text-4xl font-bold text-amber-700">${recipeData.title}</h2>
                    <p class="mt-4 max-w-3xl mx-auto text-stone-600 text-lg">${recipeData.description}</p>
                </div>
                <div class="mt-10 grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                    <div class="bg-stone-100 p-4 rounded-lg flex flex-col justify-center items-center"><span class="text-2xl">‚è≥</span><h4 class="font-bold text-stone-800">Preparo</h4><p class="text-stone-600 text-sm">${recipeData.details.tempoPreparo}</p></div>
                    <div class="bg-stone-100 p-4 rounded-lg flex flex-col justify-center items-center"><span class="text-2xl">üç≥</span><h4 class="font-bold text-stone-800">Cozimento</h4><p class="text-stone-600 text-sm">${recipeData.details.tempoCozimento}</p></div>
                    <div class="bg-stone-100 p-4 rounded-lg flex flex-col justify-center items-center"><span class="text-2xl">üçΩÔ∏è</span><h4 class="font-bold text-stone-800">Rendimento</h4><p class="text-stone-600 text-sm">${recipeData.details.rendimento}</p></div>
                    <div class="bg-stone-100 p-4 rounded-lg flex flex-col justify-center items-center"><span class="text-2xl">‚≠ê</span><h4 class="font-bold text-stone-800">Dificuldade</h4><p class="text-stone-600 text-sm">${recipeData.details.dificuldade}</p></div>
                </div>
                <div class="mt-12 grid grid-cols-1 lg:grid-cols-3 gap-x-12 gap-y-8">
                    <div class="lg:col-span-1">
                        <h3 class="text-2xl font-bold text-stone-800 mb-4 border-b-2 border-amber-500 pb-2">Planeamento</h3>
                        ${recipeData.calculator ? `<div class="bg-stone-50 p-4 rounded-lg"><label for="${recipeId}-input" class="block text-lg text-stone-700 mb-2 font-bold">${recipeData.calculator.label}</label><input type="number" id="${recipeId}-input" value="${recipeData.calculator.default_value}" min="0.5" step="1" class="w-full p-2 border border-stone-300 rounded-lg focus:ring-2 focus:ring-amber-500"></div>` : ''}
                        <div class="mt-6"><h4 class="font-bold text-lg mb-2 text-stone-700">Checklist de Ingredientes:</h4><ul class="space-y-1 text-stone-600 text-sm" id="ingredient-list-${recipeId}"></ul></div>
                        <div class="mt-6"><h4 class="font-bold text-lg mb-2 text-stone-700">Utens√≠lios Chave:</h4><ul class="space-y-2 text-stone-600 list-disc list-inside text-sm">${recipeData.details.utensilios.map(utensil => `<li>${utensil}</li>`).join('')}</ul></div>
                    </div>
                    <div class="lg:col-span-2">
                        <h3 class="text-2xl font-bold text-stone-800 mb-4 border-b-2 border-amber-500 pb-2">Tutorial Detalhado</h3>
                        <div class="space-y-6">${recipeData.steps.map((step, index) => {
                             if (step.isSubRecipe) {
                                const subStepsHTML = step.subSteps.map(subStep => `<div class="ml-4"><h5 class="font-semibold text-lg text-stone-800 mb-1">${subStep.title}</h5><div class="prose prose-stone max-w-none text-sm"><p>${subStep.description}</p><details class="mt-3 text-xs"><summary class="font-bold text-blue-800">Ver o porqu√™</summary><div class="mt-2 bg-blue-50 text-blue-800 rounded-md p-3">${subStep.porque}</div></details><details class="mt-2 text-xs"><summary class="font-bold text-red-800">Ver ponto cr√≠tico</summary><div class="mt-2 bg-red-50 text-red-800 rounded-md p-3">${subStep.pontoCritico}</div></details></div></div>`).join('');
                                return `<div class="p-4 rounded-lg bg-amber-50 border-l-4 border-amber-400"><h4 class="font-bold text-xl text-amber-800 mb-4">${step.title}</h4><div class="space-y-4">${subStepsHTML}</div></div>`;
                            }
                            let stepCounter = 0;
                            recipeData.steps.forEach((s, i) => { if (!s.isSubRecipe) { stepCounter++; if (i === index) index = stepCounter -1; } });
                            return `<div class="p-4 rounded-lg bg-stone-50 border-l-4 border-stone-200"><h4 class="font-bold text-xl text-stone-800 mb-2"><span class="bg-amber-600 text-white rounded-full w-8 h-8 inline-flex items-center justify-center mr-3 text-base">${index + 1}</span> ${step.title}</h4><div class="prose prose-stone max-w-none pl-11 text-sm"><p>${step.description}</p><details class="mt-3 text-xs"><summary class="font-bold text-blue-800">Ver o porqu√™</summary><div class="mt-2 bg-blue-50 text-blue-800 rounded-md p-3">${step.porque}</div></details><details class="mt-2 text-xs"><summary class="font-bold text-red-800">Ver ponto cr√≠tico</summary><div class="mt-2 bg-red-50 text-red-800 rounded-md p-3">${step.pontoCritico}</div></details></div></div>`;
                        }).join('')}</div>
                        ${recipeData.variacoes && recipeData.variacoes.length > 0 ? `<div class="mt-8"><h3 class="text-2xl font-bold text-stone-800 mb-4 border-b-2 border-amber-500 pb-2">Varia√ß√µes e Dicas</h3><div class="prose prose-stone max-w-none bg-amber-50 p-4 rounded-lg border-l-4 border-amber-400 text-sm">${recipeData.variacoes.map(item => `<p>${item}</p>`).join('')}</div></div>` : ''}
                    </div>
                </div>
            `;
        };
        
        const setupPage = () => {
            const showList = () => {
                aulasList.classList.remove('hidden');
                pageTitle.classList.remove('hidden');
                receitasContainer.classList.add('hidden');
                document.querySelectorAll('.receita-content').forEach(recipe => recipe.classList.add('hidden'));
                if (window.location.hash) {
                    history.pushState("", document.title, window.location.pathname + window.location.search);
                }
                window.scrollTo(0, 0);
            };

            const showRecipe = (recipeId) => {
                const recipeData = aulas[recipeId];
                if (recipeData) {
                    const targetId = `receita-${recipeId}`;
                    const targetElement = document.getElementById(targetId);
                    document.querySelectorAll('.receita-content').forEach(el => el.classList.add('hidden'));
                    
                    targetElement.innerHTML = generateRecipeHTML(recipeData, recipeId);
                    aulasList.classList.add('hidden');
                    pageTitle.classList.add('hidden');
                    receitasContainer.classList.remove('hidden');
                    targetElement.classList.remove('hidden');
                    window.scrollTo(0, 0);

                    if (recipeData.calculator) {
                        const input = document.getElementById(`${recipeId}-input`);
                        if(input) {
                            input.addEventListener('input', () => updateIngredients(recipeData, input.value, recipeId));
                            updateIngredients(recipeData, input.value, recipeId);
                        }
                    } else if (recipeData.ingredients && recipeData.ingredients.length > 0) {
                        updateIngredients(recipeData, 1, recipeId);
                    }
                } else {
                    showList();
                }
            };
            
            window.addEventListener('hashchange', () => {
                const hash = window.location.hash;
                if (hash) {
                    const recipeId = hash.substring(1).replace('receita-', '');
                    showRecipe(recipeId);
                } else {
                    showList();
                }
            }, false);

            if (window.location.hash) {
                const recipeId = window.location.hash.substring(1).replace('receita-', '');
                showRecipe(recipeId);
            }

            document.querySelectorAll('.aula-card').forEach(card => {
                card.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = card.dataset.target;
                    window.location.hash = targetId;
                });
            });

            backToListBtn.addEventListener('click', () => {
                showList();
            });
        };

        setupPage();
    });
</script>
</body>
</html>
